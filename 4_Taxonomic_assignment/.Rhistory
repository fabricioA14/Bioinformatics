setwd("/home/fabricio")
library(data.table)
library(ape)
library(adegenet)
local_database <- fread("local_database.txt")
local_database_filter <- local_database[,c(10:18,52)]
local_database_fasta <- list()
for (i in seq(nrow(local_database_filter))) {
firstName <- ">"
middleName[i] <- paste0(c(local_database_filter[i,1:9]), sep = ",", collapse = "")
middleName[i] <- substr(middleName[i], 1, nchar(middleName[i])-1)
local_database_fasta[[i]] <- capture.output(cat(cat(firstName, middleName[i])))
}
local_database_fasta <- list()
for (i in seq(nrow(local_database_filter))) {
First_element <- ">"
Second_element <- paste0(c(local_database_filter[i,1:9]), sep = ",", collapse = "")
Second_element <- substr(middleName[i], 1, nchar(middleName[i])-1)
local_database_fasta[[i]] <- capture.output(cat(cat(First_element, Second_element[i])))
}
local_database_fasta <- list()
First_element <- list()
Second_element <- list()
for (i in seq(nrow(local_database_filter))) {
First_element <- ">"
Second_element[i] <- paste0(c(local_database_filter[i,1:9]), sep = ",", collapse = "")
Second_element[i] <- substr(middleName[i], 1, nchar(middleName[i])-1)
local_database_fasta[[i]] <- capture.output(cat(cat(First_element, Second_element[i])))
}
for (i in seq(nrow(local_database_filter))) {
First_element <- ">"
Second_element[i] <- paste0(c(local_database_filter[i,1:9]), sep = ",", collapse = "")
Second_element[i] <- substr(Second_element[i], 1, nchar(Second_element[i])-1)
local_database_fasta[[i]] <- capture.output(cat(cat(First_element, Second_element[i])))
}
First_element <- c("a","b")
Second_element <- c("a","b")
for (i in seq(nrow(local_database_filter))) {
First_element <- ">"
Second_element[i] <- paste0(c(local_database_filter[i,1:9]), sep = ",", collapse = "")
Second_element[i] <- substr(Second_element[i], 1, nchar(Second_element[i])-1)
local_database_fasta[[i]] <- capture.output(cat(cat(First_element, Second_element[i])))
}
First_element <- c("Fill","only", "to", "create", "a", "vector")
Second_element <- c("Fill","only", "to", "create", "a", "vector")
for (i in seq(nrow(local_database_filter))) {
First_element <- ">"
Second_element[i] <- paste0(c(local_database_filter[i,1:9]), sep = ",", collapse = "")
Second_element[i] <- substr(Second_element[i], 1, nchar(Second_element[i])-1)
local_database_fasta[[i]] <- capture.output(cat(cat(First_element, Second_element[i])))
}
local_dna_fasta <- list()
Third_element <- c("Fill","only", "to", "create", "a", "vector")
local_dna_fasta <- list()
Third_element <- c("Fill","only", "to", "create", "a", "vector")
for (i in seq(nrow(local_database_filter))) {
Third_element[i] <- paste0(c(local_database_filter[i,10]), sep = "", collapse = "")
local_dna_fasta[[i]] <- capture.output(cat(Third_element[i]))
}
local_database_filter_fasta <- list(local_database_fasta,tolower(local_dna_fasta))
length(local_database_filter_fasta)
length(local_database_filter_fasta[1])
length(local_database_filter_fasta[[1]])
write.table(sapply(local_database_filter_fasta,"[",c(1:length(local_database_filter_fasta[[1]]))),
file = "test.fasta", sep = "\n", eol = "\n", row.names = F, col.names = F,
qmethod = "escape", quote = F)
obj <- fasta2DNAbin("test.fasta", chunk=10)
obj <- fasta2DNAbin("subset.fasta", chunk=10)
obj <- fasta2DNAbin("subset.fasta", chunk=10)
obj <- fasta2DNAbin("subset.fasta", chunk=10)
obj <- fasta2DNAbin("subset.fasta", chunk=10)
obj <- fasta2DNAbin("test.fasta", chunk=10)
obj
setwd("/home/fabricio/rBlast")
dna <- readDNAStringSet('subset.fasta', format='fasta')
library(annotate)
dna <- readDNAStringSet('subset.fasta', format='fasta')
library(RCurl)
dna <- readDNAStringSet('subset.fasta', format='fasta')
library(taxonomizr)
dna <- readDNAStringSet('subset.fasta', format='fasta')
library(devtools)
dna <- readDNAStringSet('subset.fasta', format='fasta')
library(Biostrings)
dna <- readDNAStringSet('subset.fasta', format='fasta')
bl <- blast(db="/home/fabricio/rBlast/local_database/test.fasta")
library(rBLAST)
bl <- blast(db="/home/fabricio/rBlast/local_database/test.fasta")
bl <- blast(db="/home/fabricio/rBlast/local_database/test.fasta")
View(dna)
cl <- predict(bl, dna[1:3999])
bl <- blast(db="/home/fabricio/rBlast/local_database/test.fasta")
library(taxonomizr)
library(devtools)
library(rBLAST)
library(annotate)
library(RCurl)
library(dplyr)
library(Biostrings)
